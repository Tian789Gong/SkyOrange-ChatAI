![](img/logo-long-chatchat-trans-v2.png)

ğŸ“ƒ **orange-Langchain** (åŸ Langchain-ChatGLM)

åŸºäº ChatGLM ç­‰å¤§è¯­è¨€æ¨¡å‹ä¸ Langchain ç­‰åº”ç”¨æ¡†æ¶å®ç°ï¼Œå¼€æºã€å¯ç¦»çº¿éƒ¨ç½²çš„æ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)å¤§æ¨¡å‹çŸ¥è¯†åº“é¡¹ç›®ã€‚

## ç›®å½•

* [ä»‹ç»](README.md#ä»‹ç»)
* [è§£å†³çš„ç—›ç‚¹](README.md#è§£å†³çš„ç—›ç‚¹)
* [å¿«é€Ÿä¸Šæ‰‹](README.md#å¿«é€Ÿä¸Šæ‰‹)
  * [1. ç¯å¢ƒé…ç½®](README.md#1-ç¯å¢ƒé…ç½®)
  * [2. æ¨¡å‹ä¸‹è½½](README.md#2-æ¨¡å‹ä¸‹è½½)
  * [3. åˆå§‹åŒ–çŸ¥è¯†åº“å’Œé…ç½®æ–‡ä»¶](README.md#3-åˆå§‹åŒ–çŸ¥è¯†åº“å’Œé…ç½®æ–‡ä»¶)
  * [4. ä¸€é”®å¯åŠ¨](README.md#4-ä¸€é”®å¯åŠ¨)
  * [5. å¯åŠ¨ç•Œé¢ç¤ºä¾‹](README.md#5-å¯åŠ¨ç•Œé¢ç¤ºä¾‹)
* [è”ç³»æˆ‘ä»¬](README.md#è”ç³»æˆ‘ä»¬)

## ä»‹ç»

ğŸ¤–ï¸ ä¸€ç§åˆ©ç”¨ [langchain](https://github.com/langchain-ai/langchain)
æ€æƒ³å®ç°çš„åŸºäºæœ¬åœ°çŸ¥è¯†åº“çš„é—®ç­”åº”ç”¨ï¼Œç›®æ ‡æœŸæœ›å»ºç«‹ä¸€å¥—å¯¹ä¸­æ–‡åœºæ™¯ä¸å¼€æºæ¨¡å‹æ”¯æŒå‹å¥½ã€å¯ç¦»çº¿è¿è¡Œçš„çŸ¥è¯†åº“é—®ç­”è§£å†³æ–¹æ¡ˆã€‚

ğŸ’¡ å— [GanymedeNil](https://github.com/GanymedeNil) çš„é¡¹ç›® [document.ai](https://github.com/GanymedeNil/document.ai)
å’Œ [AlexZhangji](https://github.com/AlexZhangji)
åˆ›å»ºçš„ [ChatGLM-6B Pull Request](https://github.com/THUDM/ChatGLM-6B/pull/216)
å¯å‘ï¼Œå»ºç«‹äº†å…¨æµç¨‹å¯ä½¿ç”¨å¼€æºæ¨¡å‹å®ç°çš„æœ¬åœ°çŸ¥è¯†åº“é—®ç­”åº”ç”¨ã€‚æœ¬é¡¹ç›®çš„æœ€æ–°ç‰ˆæœ¬ä¸­é€šè¿‡ä½¿ç”¨ [FastChat](https://github.com/lm-sys/FastChat)
æ¥å…¥ Vicuna, Alpaca, LLaMA, Koala, RWKV ç­‰æ¨¡å‹ï¼Œä¾æ‰˜äº [langchain](https://github.com/langchain-ai/langchain)
æ¡†æ¶æ”¯æŒé€šè¿‡åŸºäº [FastAPI](https://github.com/tiangolo/fastapi) æä¾›çš„ API
è°ƒç”¨æœåŠ¡ï¼Œæˆ–ä½¿ç”¨åŸºäº [Streamlit](https://github.com/streamlit/streamlit) çš„ WebUI è¿›è¡Œæ“ä½œã€‚

âœ… ä¾æ‰˜äºæœ¬é¡¹ç›®æ”¯æŒçš„å¼€æº LLM ä¸ Embedding æ¨¡å‹ï¼Œæœ¬é¡¹ç›®å¯å®ç°å…¨éƒ¨ä½¿ç”¨**å¼€æº**æ¨¡å‹**ç¦»çº¿ç§æœ‰éƒ¨ç½²**ã€‚ä¸æ­¤åŒæ—¶ï¼Œæœ¬é¡¹ç›®ä¹Ÿæ”¯æŒ
OpenAI GPT API çš„è°ƒç”¨ï¼Œå¹¶å°†åœ¨åç»­æŒç»­æ‰©å……å¯¹å„ç±»æ¨¡å‹åŠæ¨¡å‹ API çš„æ¥å…¥ã€‚

---



â›“ï¸ æœ¬é¡¹ç›®å®ç°åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿‡ç¨‹åŒ…æ‹¬åŠ è½½æ–‡ä»¶ -> è¯»å–æ–‡æœ¬ -> æ–‡æœ¬åˆ†å‰² -> æ–‡æœ¬å‘é‡åŒ– -> é—®å¥å‘é‡åŒ– ->
åœ¨æ–‡æœ¬å‘é‡ä¸­åŒ¹é…å‡ºä¸é—®å¥å‘é‡æœ€ç›¸ä¼¼çš„ `top k`ä¸ª -> åŒ¹é…å‡ºçš„æ–‡æœ¬ä½œä¸ºä¸Šä¸‹æ–‡å’Œé—®é¢˜ä¸€èµ·æ·»åŠ åˆ° `prompt`ä¸­ -> æäº¤ç»™ `LLM`ç”Ÿæˆå›ç­”ã€‚

![å®ç°åŸç†å›¾](img/langchain+chatglm.png)

ä»æ–‡æ¡£å¤„ç†è§’åº¦æ¥çœ‹ï¼Œå®ç°æµç¨‹å¦‚ä¸‹ï¼š

![å®ç°åŸç†å›¾2](img/langchain+chatglm2.png)

## å¿«é€Ÿä¸Šæ‰‹

æ¥ç€ï¼Œåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œå¹¶åœ¨è™šæ‹Ÿç¯å¢ƒå†…å®‰è£…é¡¹ç›®çš„ä¾èµ–

```shell

# æ‹‰å–ä»“åº“
$ git clone https://github.com/Tian789Gong/-LCchat.git

# è¿›å…¥ç›®å½•
$ cd ./-LCchat
# å®‰è£…å…¨éƒ¨ä¾èµ–
$ pip install -r requirements.txt 
$ pip install -r requirements_api.txt
$ pip install -r requirements_webui.txt  

# é»˜è®¤ä¾èµ–åŒ…æ‹¬åŸºæœ¬è¿è¡Œç¯å¢ƒï¼ˆFAISSå‘é‡åº“ï¼‰ã€‚å¦‚æœè¦ä½¿ç”¨ milvus/pg_vector ç­‰å‘é‡åº“ï¼Œè¯·å°† requirements.txt ä¸­ç›¸åº”ä¾èµ–å–æ¶ˆæ³¨é‡Šå†å®‰è£…ã€‚
```

### 2. æ¨¡å‹ä¸‹è½½

å¦‚éœ€åœ¨æœ¬åœ°æˆ–ç¦»çº¿ç¯å¢ƒä¸‹è¿è¡Œæœ¬é¡¹ç›®ï¼Œéœ€è¦é¦–å…ˆå°†é¡¹ç›®æ‰€éœ€çš„æ¨¡å‹ä¸‹è½½è‡³æœ¬åœ°ï¼Œé€šå¸¸å¼€æº LLM ä¸ Embedding
æ¨¡å‹å¯ä»¥ä» [HuggingFace](https://huggingface.co/models) ä¸‹è½½ã€‚

ä»¥æœ¬é¡¹ç›®ä¸­é»˜è®¤ä½¿ç”¨çš„ LLM æ¨¡å‹ [THUDM/ChatGLM3-6B](https://huggingface.co/THUDM/chatglm3-6b) ä¸ Embedding
æ¨¡å‹ [BAAI/bge-large-zh](https://huggingface.co/BAAI/bge-large-zh) ä¸ºä¾‹ï¼š

ä¸‹è½½æ¨¡å‹éœ€è¦å…ˆ[å®‰è£… Git LFS](https://docs.github.com/zh/repositories/working-with-files/managing-large-files/installing-git-large-file-storage)
ï¼Œç„¶åè¿è¡Œ

```Shell
$ sudo apt-get update
$ sudo apt-get install git-lfs
$ git lfs install
$ git clone https://huggingface.co/THUDM/chatglm3-6b
$ git clone https://huggingface.co/BAAI/bge-large-zh
```

### 3. åˆå§‹åŒ–çŸ¥è¯†åº“å’Œé…ç½®æ–‡ä»¶

æŒ‰ç…§ä¸‹åˆ—æ–¹å¼åˆå§‹åŒ–è‡ªå·±çš„çŸ¥è¯†åº“å’Œç®€å•çš„å¤åˆ¶é…ç½®æ–‡ä»¶

```shell
$ python copy_config_example.py
$ python init_database.py --recreate-vs
```

### 4. ä¸€é”®å¯åŠ¨

æŒ‰ç…§ä»¥ä¸‹å‘½ä»¤å¯åŠ¨é¡¹ç›®

```shell
$ python startup.py -a
```

### 5. å¯åŠ¨ç•Œé¢ç¤ºä¾‹

å¦‚æœæ­£å¸¸å¯åŠ¨ï¼Œä½ å°†èƒ½çœ‹åˆ°ä»¥ä¸‹ç•Œé¢

1. FastAPI Docs ç•Œé¢

![](img/fastapi_docs_026.png)

2. Web UI å¯åŠ¨ç•Œé¢ç¤ºä¾‹ï¼š

- Web UI å¯¹è¯ç•Œé¢ï¼š

![img](img/LLM_success.png)

- Web UI çŸ¥è¯†åº“ç®¡ç†é¡µé¢ï¼š

![](img/init_knowledge_base.jpg)
